/****************************************************************************************************/
/*                                           INCLUDE                                                */
/****************************************************************************************************/
#include <stdio.h>
#include <stdlib.h>
#include <sys/stat.h>
#include <unistd.h>
#include <dirent.h>

/****************************************************************************************************/
/*                                           DEFINES                                                */
/****************************************************************************************************/
#define TEST_DIR_PATH "/tmp/dir_test/"
/****************************************************************************************************/
/*                                           VARIABLES                                              */
/****************************************************************************************************/

/****************************************************************************************************/
/*                                       STATIC FUNCTIONS                                           */
/****************************************************************************************************/

/****************************************************************************************************/
/*                                       PUBLIC FUNCTIONS                                           */
/****************************************************************************************************/
int main(int argc, char *argv[])
{
	DIR *dir;
	struct dirent *ent;
	char *dir_path = argv[1] ? argv[1] : TEST_DIR_PATH;
	
	/* 创建文件夹 */
	if (0 != mkdir(TEST_DIR_PATH, 0777))
	{
		printf("mkdir %s failed\n", TEST_DIR_PATH);
	}

	/* 遍历文件夹 */
	if (NULL != (dir = opendir(dir_path)))
	{
		while (NULL != (ent = readdir(dir)))
		{
			printf("ent->d_name=%s, ent->d_type=%d\n", ent->d_name, ent->d_type);
		}

		closedir(dir);
	}
	else
	{
		printf("open directory:%s failed\n", dir_path);
	}

	/* 删除文件夹 */
 	if (0 != rmdir(TEST_DIR_PATH))
	{
		printf("rmdir %s failed\n", TEST_DIR_PATH);
	}

	return 0;
}
